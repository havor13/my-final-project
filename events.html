<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Event Details | Local Event Explorer</title>
  <meta name="description" content="View details, venue location, and save or share your favorite events with Local Event Explorer.">
  <link rel="stylesheet" href="styles/styles.css">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Roboto&family=Oswald&family=Merriweather&display=swap" rel="stylesheet"> 
  <link rel="preconnect" href="https://fonts.googleapis.com"> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
  <!-- Banner Header -->
  <header class="site-header">
    <div class="banner">
      <h1>üéü Event Details</h1>
      <p class="author">Created by Sampson Havor</p>
    </div>
    <nav aria-label="Main navigation">
      <a href="index.html">Home</a> | 
      <a href="favorites.html">Favorites</a> | 
      <a href="events.html" class="active">Events</a>
    </nav>
  </header>

  <main>
    <!-- Hero Section -->
    <section class="hero">
      <h2>Explore Your Selected Event</h2>
      <p>Find all the details, location, and options to save or share.</p>
    </section>

    <!-- Event Detail Card -->
    <section id="eventDetail" class="event-detail-card" aria-live="polite"></section>

  <!-- Featured Event Banners -->
  <section class="banner-gallery">
    <!-- Afrobeat Concert -->
    <img src="images/afrobeat.webp" alt="Banner for Afrobeat Concert" class="event-banner fade-in">

    <!-- Tech Innovation Fair -->
    <img src="images/techfair.webp" alt="Banner for Tech Innovation Fair" class="event-banner fade-in">

    <!-- Family Fun Festival -->
    <img src="images/familyfestival.webp" alt="Banner for Family Fun Festival" class="event-banner fade-in">

    <!-- Highlife Night -->
    <img src="images/highlife.webp" alt="Banner for Highlife Night" class="event-banner fade-in">

    <!-- Football Derby -->
    <img src="images/football.webp" alt="Banner for Football Derby" class="event-banner fade-in">

    <!-- Cultural Dance Festival -->
    <img src="images/dancefestival.webp" alt="Banner for Cultural Dance Festival" class="event-banner fade-in">
 </section>

</main>

  <!-- Footer -->
  <footer class="site-footer">
    <p>¬© 2026 Local Event Explorer | Author: Sampson Havor</p>
  </footer>

  <!-- Scripts -->
  <!-- Load API functions first -->
  <script src="scripts/api.js"></script>
  <!-- Inline script that uses those functions -->
  <script>
    async function loadEvent() {
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");
      const detailSection = document.getElementById("eventDetail");

      if (!id) {
        detailSection.innerHTML = `
          <div class="empty-state fade-in">
            <p>‚ö†Ô∏è No event selected. Please choose an event from the list.</p>
            <a href="index.html" class="btn">Back to Home</a>
            <a href="events.html" class="btn">Browse Events</a>
          </div>
        `;
        return;
      }

      detailSection.innerHTML = "<p>Loading event details...</p>";

      try {
        const event = await fetchEventById(id);
        console.log("Event ID from URL:", id);
        console.log("Fetched event:", event);

        if (!event) {
          detailSection.innerHTML = `
            <div class="empty-state fade-in">
              <p>‚ö†Ô∏è Event not found in data.json or could not be loaded.</p>
              <a href="events.html" class="btn">Back to Events</a>
            </div>
          `;
          return;
        }

        const venueName = event.venue || "Unknown Venue";
        const mapUrl = getMapEmbedUrl(venueName);

        detailSection.innerHTML = `
          <img src="${event.image || 'placeholder.jpg'}" alt="Banner for ${event.name}" class="event-banner fade-in">
          <h2>${event.name}</h2>
          <p><strong>Date:</strong> ${event.date || "TBA"} ${event.time ? '@ ' + event.time : ''}</p>
          <p><strong>Venue:</strong> ${venueName}, ${event.city || ""}</p>
          <p><strong>Category:</strong> ${event.category || ""}</p>
          <p class="description">${event.description || "No description available."}</p>
          <p class="price"><strong>Price:</strong> ${event.price || "TBA"}</p>
      
          <div class="card-actions">
            <button id="favBtn">‚≠ê Save to Favorites</button>
            <button id="shareBtn">üì§ Share Event</button>
            ${event.url ? `<a href="${event.url}" target="_blank" class="btn">Official Page</a>` : ""}
          </div>
        `;

        document.getElementById("favBtn").addEventListener("click", () => saveFavorite(event));
        document.getElementById("shareBtn").addEventListener("click", () => shareEvent(event));

      } catch (err) {
        console.error("‚ùå Error fetching event details:", err);
        detailSection.innerHTML = `
          <div class="empty-state fade-in">
            <p>‚ùå Could not load data.json ‚Äî please check file path or server setup.</p>
            <a href="events.html" class="btn">Back to Events</a>
          </div>
        `;
      }
    }

    function saveFavorite(eventObj) {
      let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
      if (!favorites.find(fav => fav.id === eventObj.id)) {
        favorites.push(eventObj);
        localStorage.setItem("favorites", JSON.stringify(favorites));
        alert(`${eventObj.name} added to favorites!`);
      } else {
        alert(`${eventObj.name} is already in favorites.`);
      }
    }

    function shareEvent(eventObj) {
      const url = window.location.href;
      if (navigator.share) {
        navigator.share({
          title: eventObj.name,
          text: `Check out this event: ${eventObj.name}`,
          url: url
        });
      } else {
        navigator.clipboard.writeText(url);
        alert("Event link copied to clipboard!");
      }
    }

    loadEvent();
  </script>
</body>
</html>
